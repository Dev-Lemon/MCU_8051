C51 COMPILER V9.01   PWM                                                                   06/01/2018 00:11:58 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE PWM
OBJECT MODULE PLACED IN PWM.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE PWM.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include"PWM.h"
   2          void PWM_Init(unsigned int ck){
   3   1              speed1 = speed2 = 1;    
   4   1              TMOD &= 0xF0;           // Xoa di cac bit chon mode cua Timer0
   5   1              TMOD |= 0x01;           // Timer0 hoat dong o mode 1
   6   1              
   7   1              ET0 = 1;                        // Cho phep ngat Timer0
   8   1              EA = 1;                         // Cho phep ngat toan cuc
   9   1              
  10   1              T  = ck;
  11   1              Ton = T/2;                      // Duty Cycle = 50%
  12   1              Toff = T - Ton;
  13   1      
  14   1              Ton_h_reload = (65536-Ton)>>8;
  15   1              Ton_l_reload = (65536-Ton)&0x00FF;
  16   1      
  17   1              Toff_h_reload = (65536-Toff)>>8;
  18   1              Toff_l_reload = (65536-Toff)&0x00FF;
  19   1              
  20   1              TH0 = Ton_h_reload;
  21   1              TL0 = Ton_l_reload;     
  22   1      }
  23          void PWM_Start(){
  24   1              TR0 = 1;                        // Timer0 bat dau dem
  25   1      }
  26          
  27          void PWM_Stop(){
  28   1              TR0 = 0;                        // Timer0 ngung dem
  29   1      }
  30          
  31          void PWM_Set_Duty(unsigned char duty){
  32   1              if(duty == 0)
  33   1              {
  34   2                      speed1 = speed2 = 0;
  35   2                      ET0 = 0;
  36   2              }
  37   1              else if(duty == 100)
  38   1              {
  39   2                      speed1 = speed2 = 1;
  40   2                      ET0 = 0;
  41   2              }
  42   1              else
  43   1              {
  44   2                      Ton = ((unsigned long)T)*duty/100;
  45   2                      Toff = T - Ton;
  46   2                      Ton_h_reload = (65536-Ton)>>8;
  47   2                      Ton_l_reload = (65536-Ton)&0x00FF;
  48   2              
  49   2                      Toff_h_reload = (65536-Toff)>>8;
  50   2                      Toff_l_reload = (65536-Toff)&0x00FF;
  51   2      
  52   2                      ET0 = 1;
  53   2              }
  54   1      }

C51 COMPILER V9.01   PWM                                                                   06/01/2018 00:11:58 PAGE 2   


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    257    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
